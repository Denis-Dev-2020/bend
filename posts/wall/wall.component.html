<div data-bs-theme="dark" class="bg-dark">
  <div class="row">
    <div>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~ OVERLAYS ~~~~~~~~~~~~~~~~~~~~~~ -->
      <div class="overlay" *ngIf="isCreatePostOpen" (click)="closeCreatePostAndRefresh()">
        <div class="overlay-content" (click)="($event.stopPropagation())">
          <i class="fa fa-times" aria-hidden="true" (click)="closeCreatePostAndRefresh()"></i>
          <app-createpost (create)="createPost(); closeCreatePostAndRefresh()"></app-createpost>
        </div>
      </div>
      <div class="overlay" *ngIf="isDeleteConfirmationOpen" (click)="closeDeleteConfirmation()">
        <div class="overlay-content" (click)="($event.stopPropagation())" style="text-align: center;">
          <div class="text-white">
            <h4>Are you sure you want to delete this post ?</h4>
          </div>
          <div class="mt-3">
            <button class="btn btn-danger me-2" (click)="confirmDelete();">Delete</button>
            <button class="btn btn-secondary" (click)="closeDeleteConfirmation()">Cancel</button>
          </div>
        </div>
      </div>
      <!-- ~~~~~~~~~~~~~~~~~~~~~~ /OVERLAYS ~~~~~~~~~~~~~~~~~~~~~~ -->
      <div class="d-flex flex-row">
        <!-- ~~~~~~~~~~~~~~~~~~~~~~ POSTS SIDEBAR ~~~~~~~~~~~~~~~~~~~~~~ -->
        <div class="d-flex flex-column align-items-stretch flex-shrink-0 bg-body-tertiary" style="width: 300px;">
          <div class="d-flex align-items-center flex-shrink-0 link-body-emphasis text-decoration-none justify-content-between" style="justify-content: center !important;">
              <span class="fs-6 fw-semibold " style="cursor: pointer;margin-bottom: -50px;">
                {{ selectedTopic }}
                <br>
                {{ selectedSubtopic }}
                <br>
                Blockchain Technology
              </span>
          </div>
           <div class="border-bottom p-3" style="text-align: end;">
              <i class="fas fa-plus" (click)="openCreatePost()" aria-hidden="true"></i>
            </div>
          <div class="list-group list-group-flush scrollarea">
            <ng-container *ngIf="posts$ | async as posts">
              <a *ngFor="let post of posts$ | async" (click)="selectPost(post)" class="list-group-item list-group-item-action py-3 lh-sm" style="cursor: pointer;">
                <div class="d-flex w-100 align-items-center justify-content-between">
                  <strong class="mb-1">
                    {{ post.title }}
                  </strong>
                  <small class="text-body-secondary">
                    <i class="fa fa-trash" aria-hidden="true" *ngIf="post.user === userIdNumber" (click)="openDeleteConfirmation(post); $event.stopPropagation();"></i>
                  </small>
                </div>
                <small class="text-body-secondary">{{ post.created | date:'shortTime' }} - {{ post.created | date }}</small>
                <!-- ~~~~~~~~~~~~~~~~~~~~~~ General feedback ~~~~~~~~~~~~~~~~~~~~~~ -->
                <div *ngIf="!(isFeedbackActive(post.id, true) || isFeedbackActive(post.id, false))" style="text-align: end;">
                  <small class="text-body-secondary">
                    <button class="btn btn-dark feedbackPositiveButtons" type="button" (click)="createPositiveFeedback(post.id)">
                      <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                      <span>{{ getFeedbackCount(post.id, 'feedback_type_true_count') }}</span>
                    </button>
                    <button class="btn btn-dark feedbackNegativeButtons" type="button" (click)="createNegativeFeedback(post.id)">
                      <i class="fa fa-thumbs-down" aria-hidden="true"></i>
                      <span>{{ getFeedbackCount(post.id, 'feedback_type_false_count') }}</span>
                    </button>
                  </small>
                </div>
                <!-- ~~~~~~~~~~~~~~~~~~~~~~ /General feedback ~~~~~~~~~~~~~~~~~~~~~~ -->
                <!-- ~~~~~~~~~~~~~~~~~~~~~~ Personal feedback ~~~~~~~~~~~~~~~~~~~~~~ -->
                <div style="display: flex;justify-content: end;">
                  <button class="btn btn-light feedbackPositiveButtons" *ngIf="isFeedbackActive(post.id, true)" (click)="removeFeedback(post.id)">
                    <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                    <span>{{ getFeedbackCount(post.id, 'feedback_type_true_count') }}</span>
                  </button>
                  <button class="btn btn-dark feedbackPositiveButtons" *ngIf="isFeedbackActive(post.id, false)" [disabled]="isFeedbackActive(post.id, true)" (click)="removeFeedbackCreatePositiveFeedback(post.id);">
                    <i class="fa fa-thumbs-up" aria-hidden="true"></i>
                    <span>{{ getFeedbackCount(post.id, 'feedback_type_true_count') }}</span>
                  </button>
                  <button class="btn btn-dark feedbackNegativeButtons" *ngIf="isFeedbackActive(post.id, true)" [disabled]="isFeedbackActive(post.id, false)" (click)="removeFeedbackCreateNegativeFeedback(post.id);">
                    <i class="fa fa-thumbs-down" aria-hidden="true"></i>
                    <span>{{ getFeedbackCount(post.id, 'feedback_type_false_count') }}</span>
                  </button>
                  <button class="btn btn-light feedbackNegativeButtons" *ngIf="isFeedbackActive(post.id, false)" (click)="removeFeedback(post.id)">
                    <i class="fa fa-thumbs-down" aria-hidden="true"></i>
                    <span>{{ getFeedbackCount(post.id, 'feedback_type_false_count') }}</span>
                  </button>
                </div>
                <!-- ~~~~~~~~~~~~~~~~~~~~~~ /Personal feedback ~~~~~~~~~~~~~~~~~~~~~~ -->
              </a>
            </ng-container>
          </div>
        </div>
        <!-- ~~~~~~~~~~~~~~~~~~~~~~ /POSTS SIDEBAR ~~~~~~~~~~~~~~~~~~~~~~ -->
      </div>
    </div>
  </div>
</div>